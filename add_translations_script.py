#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —à–∞–±–ª–æ–Ω—ã
"""
import re

def add_trans_tags(file_path, translations):
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–≥–∏ {% trans %} –≤ —Ñ–∞–π–ª"""
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()

    # –î–æ–±–∞–≤–ª—è–µ–º {% load i18n %} –µ—Å–ª–∏ –Ω–µ—Ç
    if '{% load i18n %}' not in content and '{% load static i18n %}' not in content:
        if '{% load static %}' in content:
            content = content.replace('{% load static %}', '{% load static i18n %}')
        elif '{% extends' in content:
            lines = content.split('\n')
            for i, line in enumerate(lines):
                if '{% extends' in line:
                    lines.insert(i + 1, '{% load i18n %}')
                    break
            content = '\n'.join(lines)

    # –ó–∞–º–µ–Ω—è–µ–º —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Ç–µ–≥–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
    for old, new in translations.items():
        # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
        old_escaped = re.escape(old)
        # –ó–∞–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â—ë –Ω–µ –æ–±—ë—Ä–Ω—É—Ç–æ
        pattern = f'(?<!{{% trans ")(?<!{{% trans \')(?<!">)(?<!\')({old_escaped})(?!</span>)(?!" %}})(?!\' %}})'
        content = re.sub(pattern, new, content)

    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)

    print(f"‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω: {file_path}")


# –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
translations_all = {
    # tool_detail.html
    '–ì–ª–∞–≤–Ω–∞—è': '{% trans "–ì–ª–∞–≤–Ω–∞—è" %}',
    '–ö–∞—Ç–∞–ª–æ–≥': '{% trans "–ö–∞—Ç–∞–ª–æ–≥" %}',
    '–ó–∞–ª–æ–≥:': '{% trans "–ó–∞–ª–æ–≥:" %}',
    '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞—Ä–µ–Ω–¥—ã': '{% trans "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞—Ä–µ–Ω–¥—ã" %}',
    '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞': '{% trans "–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞" %}',
    '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è': '{% trans "–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è" %}',
    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π:': '{% trans "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π:" %}',
    '–°—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã:': '{% trans "–°—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã:" %}',
    '–ó–∞–ª–æ–≥': '{% trans "–ó–∞–ª–æ–≥" %}',
    '–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:': '{% trans "–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:" %}',
    '–î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∞—Ä–µ–Ω–¥—ã': '{% trans "–î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∞—Ä–µ–Ω–¥—ã" %}',
    '–°–µ–π—á–∞—Å –≤ –∞—Ä–µ–Ω–¥–µ': '{% trans "–°–µ–π—á–∞—Å –≤ –∞—Ä–µ–Ω–¥–µ" %}',
    '–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å': '{% trans "–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å" %}',
    '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω': '{% trans "–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω" %}',
    '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏': '{% trans "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏" %}',
    '–û–ø–∏—Å–∞–Ω–∏–µ': '{% trans "–û–ø–∏—Å–∞–Ω–∏–µ" %}',
    '–û—Ç–∑—ã–≤—ã': '{% trans "–û—Ç–∑—ã–≤—ã" %}',
    '–•–∏—Ç': '{% trans "–•–∏—Ç" %}',
    '–æ—Ç–∑—ã–≤–æ–≤': '{% trans "–æ—Ç–∑—ã–≤–æ–≤" %}',
    '–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤': '{% trans "–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤" %}',
    '–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞': '{% trans "–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞" %}',
    '–í–∞—à –æ—Ç–∑—ã–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)': '{% trans "–í–∞—à –æ—Ç–∑—ã–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" %}',
    '–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º –æ–ø—ã—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞...': '{% trans "–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º –æ–ø—ã—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞..." %}',
    '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤': '{% trans "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤" %}',
    '–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤': '{% trans "–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤" %}',
    '–í–æ–π—Ç–∏': '{% trans "–í–æ–π—Ç–∏" %}',
    '–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!': '{% trans "–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!" %}',
    '–ü–æ—Ö–æ–∂–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã': '{% trans "–ü–æ—Ö–æ–∂–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã" %}',
    '–í—Å–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏': '{% trans "–í—Å–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" %}',

    # faq.html
    '–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã': '{% trans "–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã" %}',
    '–û—Ç–≤–µ—Ç—ã –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ–± –∞—Ä–µ–Ω–¥–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤': '{% trans "–û—Ç–≤–µ—Ç—ã –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ–± –∞—Ä–µ–Ω–¥–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤" %}',
    '–ù–µ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç –Ω–∞ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å?': '{% trans "–ù–µ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç –Ω–∞ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å?" %}',
    '–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º': '{% trans "–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º" %}',
    'WhatsApp': '{% trans "WhatsApp" %}',
    'Telegram': '{% trans "Telegram" %}',
    '–ü–æ–∑–≤–æ–Ω–∏—Ç—å': '{% trans "–ü–æ–∑–≤–æ–Ω–∏—Ç—å" %}',
    'FAQ –ø–æ–∫–∞ –ø—É—Å—Ç–æ': '{% trans "FAQ –ø–æ–∫–∞ –ø—É—Å—Ç–æ" %}',
    '–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –æ—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã': '{% trans "–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –æ—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã" %}',
    '–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥': '{% trans "–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥" %}',

    # create_request.html
    '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥—ã': '{% trans "–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥—ã" %}',
    '–í–∞—à–µ –∏–º—è': '{% trans "–í–∞—à–µ –∏–º—è" %}',
    '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤': '{% trans "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" %}',
    'Email': '{% trans "Email" %}',
    '–¢–µ–ª–µ—Ñ–æ–Ω': '{% trans "–¢–µ–ª–µ—Ñ–æ–Ω" %}',
    '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π': '{% trans "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" %}',
    '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è...': '{% trans "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è..." %}',
    '–¶–µ–Ω–∞ –∑–∞ –¥–µ–Ω—å': '{% trans "–¶–µ–Ω–∞ –∑–∞ –¥–µ–Ω—å" %}',
    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π': '{% trans "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π" %}',
    '–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ': '{% trans "–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ" %}',
    '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É': '{% trans "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É" %}',
    '–û—Ç–ø—Ä–∞–≤–ª—è—è –∑–∞—è–≤–∫—É, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∞—Ä–µ–Ω–¥—ã': '{% trans "–û—Ç–ø—Ä–∞–≤–ª—è—è –∑–∞—è–≤–∫—É, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∞—Ä–µ–Ω–¥—ã" %}',

    # dashboard/index.html
    '–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç': '{% trans "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç" %}',
    '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å,': '{% trans "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å," %}',
    '–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫': '{% trans "–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫" %}',
    '–ê–∫—Ç–∏–≤–Ω—ã—Ö': '{% trans "–ê–∫—Ç–∏–≤–Ω—ã—Ö" %}',
    '–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö': '{% trans "–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö" %}',
    '–ö–∞—Ç–∞–ª–æ–≥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤': '{% trans "–ö–∞—Ç–∞–ª–æ–≥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤" %}',
    '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å': '{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å" %}',
    '–í—Å–µ –∑–∞—è–≤–∫–∏': '{% trans "–í—Å–µ –∑–∞—è–≤–∫–∏" %}',
    '–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏': '{% trans "–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏" %}',
    '–ù–æ–º–µ—Ä': '{% trans "–ù–æ–º–µ—Ä" %}',
    '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç': '{% trans "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç" %}',
    '–ü–µ—Ä–∏–æ–¥': '{% trans "–ü–µ—Ä–∏–æ–¥" %}',
    '–°—É–º–º–∞': '{% trans "–°—É–º–º–∞" %}',
    '–°—Ç–∞—Ç—É—Å': '{% trans "–°—Ç–∞—Ç—É—Å" %}',
    '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫': '{% trans "–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫" %}',
    '–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø–µ—Ä–≤—É—é –∞—Ä–µ–Ω–¥—É': '{% trans "–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø–µ—Ä–≤—É—é –∞—Ä–µ–Ω–¥—É" %}',
}

# –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã –∫ —Ñ–∞–π–ª–∞–º
files_to_process = [
    '/home/alex/moldtool/templates/catalog/tool_detail.html',
    '/home/alex/moldtool/templates/catalog/faq.html',
    '/home/alex/moldtool/templates/rentals/create_request.html',
    '/home/alex/moldtool/templates/dashboard/index.html',
]

print("üöÄ –ù–∞—á–∏–Ω–∞—é –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤...\n")
for file_path in files_to_process:
    try:
        add_trans_tags(file_path, translations_all)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ {file_path}: {e}")

print("\n‚ú® –ì–æ—Ç–æ–≤–æ!")
